<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>sentinel</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“¡</text></svg>">
</head>
<body>

  <!-- CRT Scanline Overlay -->
  <div id="crt-overlay"></div>

  <!-- â•â•â• HEADER â•â•â• -->
  <header id="header">
    <div class="header-left">
      <span class="logo">â–“ SENTINEL</span>
      <span class="version">v1.0</span>
    </div>
    <nav id="nav-desktop">
      <button class="nav-btn active" data-view="radar" title="Radar view (R)">â—‰ RADAR</button>
      <button class="nav-btn" data-view="feed" title="Feed view (F)">â‰¡ FEED</button>
      <button class="nav-btn" data-view="map" title="Map view (M)">âŠ• MAP</button>
      <button class="nav-btn" data-view="saved" title="Saved items (S)">â˜… SAVED</button>
    </nav>
    <div class="header-right">
      <div class="search-box">
        <input type="text" id="search-input" placeholder="/ SEARCH..." autocomplete="off" spellcheck="false">
      </div>
      <button id="mute-btn" class="icon-btn" title="Toggle radar sound">ğŸ”Š</button>
      <button id="refresh-btn" class="icon-btn" title="Refresh now">âŸ³</button>
      <button id="settings-btn" class="icon-btn" title="Settings">âš™</button>
      <button id="auth-btn" class="icon-btn" title="Sign in">ğŸ‘¤</button>
    </div>
  </header>

  <!-- â•â•â• FILTER BAR â•â•â• -->
  <div id="filter-bar">
    <div class="filters">
      <button class="filter-btn active" data-category="all">ALL</button>
      <button class="filter-btn" data-category="technology">TECH</button>
      <button class="filter-btn" data-category="politics">POLITICS</button>
      <button class="filter-btn" data-category="science">SCIENCE</button>
      <button class="filter-btn" data-category="business">BUSINESS</button>
      <button class="filter-btn" data-category="entertainment">ENTERTAIN</button>
      <button class="filter-btn" data-category="sports">SPORTS</button>
      <button class="filter-btn" data-category="world">WORLD</button>
      <button class="filter-btn" data-category="community">COMMUNITY</button>
    </div>
    <div class="source-filters">
      <label class="source-toggle"><input type="checkbox" data-source="reddit" checked> Reddit</label>
      <label class="source-toggle"><input type="checkbox" data-source="hackernews" checked> HN</label>
      <label class="source-toggle"><input type="checkbox" data-source="rss" checked> RSS</label>
      <label class="source-toggle"><input type="checkbox" data-source="newsapi" checked> NewsAPI</label>
      <label class="source-toggle"><input type="checkbox" data-source="guardian" checked> Guardian</label>
      <label class="source-toggle"><input type="checkbox" data-source="wikinews" checked> WikiNews</label>
    </div>
  </div>

  <!-- â•â•â• MAIN CONTENT â•â•â• -->
  <main id="main">

    <!-- RADAR VIEW -->
    <div id="view-radar" class="view active">
      <canvas id="radar-canvas"></canvas>
      <div id="radar-tooltip" class="tooltip hidden"></div>
      <div id="radar-info">
        <span id="radar-count">Scanning...</span>
      </div>
    </div>

    <!-- FEED VIEW -->
    <div id="view-feed" class="view">
      <div id="feed-container">
        <div id="feed-list"></div>
        <div id="feed-loading" class="loading">SCANNING FREQUENCIES...</div>
        <button id="feed-load-more" class="load-more hidden">â–¼ LOAD MORE SIGNALS â–¼</button>
      </div>
    </div>

    <!-- MAP VIEW -->
    <div id="view-map" class="view">
      <div id="map-container"></div>
      <div id="map-info">
        <span id="map-count">Triangulating...</span>
      </div>
    </div>

    <!-- SAVED VIEW -->
    <div id="view-saved" class="view">
      <div id="saved-container">
        <div id="saved-header">
          <h2>â˜… SAVED INTELLIGENCE</h2>
          <button id="clear-saved" class="btn-sm">PURGE ALL</button>
        </div>
        <div id="saved-list"></div>
        <div id="saved-empty" class="empty-state">
          <p>[ NO SAVED INTEL ]</p>
          <p class="hint">Bookmark articles from any view to cache them here.</p>
        </div>
      </div>
    </div>

  </main>

  <!-- â•â•â• ARTICLE DETAIL PANEL â•â•â• -->
  <div id="detail-overlay" class="overlay hidden"></div>
  <div id="detail-panel" class="side-panel hidden">
    <div class="panel-header">
      <span class="panel-badge" id="detail-source"></span>
      <span class="panel-badge" id="detail-category"></span>
      <button id="detail-close" class="icon-btn" title="Close (Esc)">âœ•</button>
    </div>
    <div class="panel-body">
      <h2 id="detail-title"></h2>
      <div class="detail-meta">
        <span id="detail-author"></span>
        <span id="detail-time"></span>
        <span id="detail-score"></span>
      </div>
      <img id="detail-image" class="detail-img hidden" alt="">
      <p id="detail-snippet"></p>
      <div class="detail-actions">
        <a id="detail-link" href="#" target="_blank" rel="noopener" class="btn">OPEN SOURCE â†—</a>
        <a id="detail-comments-link" href="#" target="_blank" rel="noopener" class="btn btn-outline">DISCUSSION â†—</a>
        <button id="detail-save" class="btn btn-outline">â˜† SAVE</button>
        <button id="detail-share" class="btn btn-outline" title="Share / Copy link">â˜ SHARE</button>
      </div>
      <div class="detail-reactions">
        <button id="detail-like" class="react-btn" title="Like â€” boost similar content">ğŸ‘ LIKE</button>
        <button id="detail-dislike" class="react-btn" title="Dislike â€” show less like this">ğŸ‘ DISLIKE</button>
        <button id="detail-showless" class="react-btn" title="Show less from this source">ğŸ“‰ SHOW LESS</button>
        <button id="detail-block" class="react-btn react-danger" title="Block â€” never show again">ğŸš« BLOCK</button>
      </div>
      <div id="detail-discussion" class="detail-discussion">
        <h3 class="discussion-header">ğŸ’¬ DISCUSSION</h3>
        <div id="discussion-loading" class="discussion-loading hidden">Scanning threads...</div>
        <div id="discussion-list" class="discussion-list"></div>
        <div id="discussion-empty" class="discussion-empty hidden">No discussion data available for this source.</div>
      </div>
    </div>
  </div>

  <!-- â•â•â• SETTINGS PANEL â•â•â• -->
  <div id="settings-overlay" class="overlay hidden"></div>
  <div id="settings-panel" class="side-panel hidden">
    <div class="panel-header">
      <h2>âš™ CONFIGURATION</h2>
      <button id="settings-close" class="icon-btn">âœ•</button>
    </div>
    <div class="panel-body">
      <div class="setting-group">
        <label>Auto-refresh interval (seconds)</label>
        <input type="number" id="setting-refresh" value="120" min="30" max="600" step="10">
      </div>
      <div class="setting-group">
        <label>CRT Scanline Effect</label>
        <label class="switch">
          <input type="checkbox" id="setting-crt" checked>
          <span>Enabled</span>
        </label>
      </div>
      <div class="setting-group setting-account">
        <h3>ğŸ‘¤ Account</h3>
        <p class="hint" id="setting-auth-hint">Sign in to sync preferences across devices.</p>
        <button id="setting-auth-btn" class="btn">â–¸ SIGN IN / SIGN UP</button>
      </div>
      <div class="setting-group">
        <label>Radar Sound</label>
        <label class="switch">
          <input type="checkbox" id="setting-sound">
          <span>Enabled</span>
        </label>
      </div>
      <div class="setting-group">
        <label>Local News Region</label>
        <select id="setting-country">
          <option value="auto">Auto-detect</option>
          <option value="us">ğŸ‡ºğŸ‡¸ United States</option>
          <option value="gb">ğŸ‡¬ğŸ‡§ United Kingdom</option>
          <option value="ca">ğŸ‡¨ğŸ‡¦ Canada</option>
          <option value="au">ğŸ‡¦ğŸ‡º Australia</option>
          <option value="de">ğŸ‡©ğŸ‡ª Germany</option>
          <option value="fr">ğŸ‡«ğŸ‡· France</option>
          <option value="in">ğŸ‡®ğŸ‡³ India</option>
          <option value="jp">ğŸ‡¯ğŸ‡µ Japan</option>
          <option value="br">ğŸ‡§ğŸ‡· Brazil</option>
          <option value="za">ğŸ‡¿ğŸ‡¦ South Africa</option>
          <option value="ng">ğŸ‡³ğŸ‡¬ Nigeria</option>
          <option value="ae">ğŸ‡¦ğŸ‡ª UAE</option>
          <option value="sg">ğŸ‡¸ğŸ‡¬ Singapore</option>
          <option value="kr">ğŸ‡°ğŸ‡· South Korea</option>
          <option value="mx">ğŸ‡²ğŸ‡½ Mexico</option>
          <option value="it">ğŸ‡®ğŸ‡¹ Italy</option>
          <option value="es">ğŸ‡ªğŸ‡¸ Spain</option>
          <option value="nl">ğŸ‡³ğŸ‡± Netherlands</option>
          <option value="se">ğŸ‡¸ğŸ‡ª Sweden</option>
          <option value="pl">ğŸ‡µğŸ‡± Poland</option>
          <option value="ph">ğŸ‡µğŸ‡­ Philippines</option>
        </select>
        <p class="hint">Adds local headlines from your selected region.</p>
      </div>
      <div class="setting-group">
        <label>Radar Sweep Speed</label>
        <select id="setting-radar-speed">
          <option value="slow">Slow</option>
          <option value="normal" selected>Normal</option>
          <option value="fast">Fast</option>
        </select>
      </div>
      <div class="setting-group">
        <h3>ğŸ“¡ Subreddit Sources</h3>
        <p class="hint">Toggle subreddits to tailor your feed. More subs = more signals.</p>
        <div class="sub-counter"><span id="sub-count">0</span> active sources</div>
        <div id="sub-manager"></div>
        <div class="sub-custom-add">
          <input type="text" id="sub-custom-input" placeholder="r/subreddit" spellcheck="false" autocomplete="off">
          <button id="sub-custom-btn" class="btn">+ ADD</button>
        </div>
      </div>
      <div class="setting-group">
        <h3>Interest Profile</h3>
        <p class="hint">Your click patterns shape the ranking algorithm</p>
        <div id="interest-chart"></div>
      </div>
      <div class="setting-group">
        <h3>Keyboard Shortcuts</h3>
        <div class="shortcuts-list">
          <div><kbd>R</kbd> Radar view</div>
          <div><kbd>F</kbd> Feed view</div>
          <div><kbd>M</kbd> Map view</div>
          <div><kbd>S</kbd> Saved view</div>
          <div><kbd>/</kbd> Focus search</div>
          <div><kbd>Esc</kbd> Close panels</div>
        </div>
      </div>

      <div class="setting-group">
        <button id="setting-clear-data" class="btn btn-danger">âš  WIPE ALL LOCAL DATA</button>
      </div>
    </div>
  </div>

  <!-- â•â•â• AUTH MODAL â•â•â• -->
  <div id="auth-overlay" class="overlay hidden"></div>
  <div id="auth-modal" class="auth-modal hidden">
    <div class="auth-header">
      <span>â–“ AUTHENTICATE</span>
      <button id="auth-modal-close" class="icon-btn">âœ•</button>
    </div>
    <div class="auth-tabs" id="auth-tabs">
      <button class="auth-tab active" data-tab="signin">SIGN IN</button>
      <button class="auth-tab" data-tab="signup">SIGN UP</button>
    </div>
    <form id="auth-form" autocomplete="off">
      <div class="auth-field">
        <label>EMAIL</label>
        <input type="email" id="auth-email" required spellcheck="false" placeholder="operator@sentinel.io">
      </div>
      <div class="auth-field">
        <label>PASSWORD</label>
        <input type="password" id="auth-password" required minlength="6" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
      </div>
      <button type="submit" class="auth-submit">â–¸ AUTHENTICATE</button>
      <div id="auth-status" class="auth-status">> Awaiting credentials...</div>
    </form>
    <div id="auth-user-info" class="auth-user-info hidden">
      <div class="auth-user-email" id="auth-user-email"></div>
      <div class="auth-user-since" id="auth-user-since">Session active</div>
      <div class="auth-sync-label" id="auth-sync-status">â˜ Synced to cloud</div>
      <button id="auth-signout" class="btn btn-danger">â—‰ SIGN OUT</button>
    </div>
  </div>

  <!-- â•â•â• STATUS BAR â•â•â• -->
  <footer id="status-bar">
    <span id="status-connection">â— ONLINE</span>
    <span id="status-sources">Sources: â€”</span>
    <span id="status-items">Signals: â€”</span>
    <span id="status-region">Region: â€”</span>
    <span id="status-refresh">Next scan: â€”</span>
    <span id="status-time" class="status-right"></span>
  </footer>

  <!-- â•â•â• MOBILE BOTTOM NAV â•â•â• -->
  <nav id="mobile-nav">
    <button class="mobile-nav-btn active" data-view="radar">
      <span class="mnav-icon">â—‰</span>
      <span class="mnav-label">Radar</span>
    </button>
    <button class="mobile-nav-btn" data-view="feed">
      <span class="mnav-icon">â‰¡</span>
      <span class="mnav-label">Feed</span>
    </button>
    <button class="mobile-nav-btn" data-view="map">
      <span class="mnav-icon">âŠ•</span>
      <span class="mnav-label">Map</span>
    </button>
    <button class="mobile-nav-btn" data-view="saved">
      <span class="mnav-icon">â˜…</span>
      <span class="mnav-label">Saved</span>
    </button>
  </nav>

  <!-- â•â•â• SCRIPTS â•â•â• -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="/js/store.js"></script>
  <script src="/js/api.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/radar.js"></script>
  <script src="/js/worldmap.js"></script>
  <script src="/js/timeline.js"></script>
  <script src="/js/app.js"></script>

</body>
</html>
